sudo: required
language: ruby
rvm: 2.4.0
os: linux
env:
  global:
    - secure: O3wkIssbcpJyexwxyZwzDBpRW1t+/7VCCwUGS13LUsFWaZu8iK9vlzpSjppv0FrVu0U5wYCq5Cv2xW7JYZSLd2WJXG8VkmvuOCCV5xR2aYpDvrkhS9aSEnZjsEzXOuDIl5khGLNnFOzakzWK+dWabrIz4Ry4Prp3Ep323g+Wpaym1d7CGWrRyhHahKlGd1NgsYKjq0ZhMwkJO8MQrqafGejSZBvTNx68fTkDDgF7GN5GlLmb5YTYh90EUjEUCvv7SuoF1crWYf5/QEWu81pXEj1hpD6GCjjQrxLjy7/B/7cGiCcb+/Pz8+uEkFfTVrLiziZqL9A6bBfOrpqna8x8NT+K0csn0WDcYyEw2ln6Y9dlLA1mFOBHU4HpqE48sOZn8E/ywroKQ6l6tRIh97X9ElqBaUy5UrwdIWdz/dehn5M7Z/6kx+aMcPvDMTk9SNlAsmdNVtsPpDd/3MZpIfvnzROvE+ILqTJ14nNPoKh5lH8h/6S30DIXTh5rxPo/ViS/dvNYc8CMQEc8wbmWcqu7GYKM4u2Lw3g46Eg39AOT0UAW8GPqaYBeyffNHjuvk/Xs2shfPsPdH8uyVSCGqXM8zOceBr6huF6GcBJLfNwn3pbL4cXX1Fhn/Z8PWzab1l9IWEjFma/FsdG6V9XV6HteMUbgyoqVs+IN45MuGZkjQ4I=
    - secure: C7mCh9Pl4mxH/YtnjhMueSTyulbQdADfw2LCsPCwxwT30Ic/DTj3if12y0QItDnW7fwwR83Y+vZsLUYDyrwMRAFbi8pR2nZN74Ri2CWAviynxQ2Z/dEh73Gss6eCw617eMAI5OGAZ2809vXE6zwag9j6sIksvAA7bd/n2DRSNXwOrBTs7Y+Q5J3MP4bUs2hQ65PkEbIIbHWC7wCSY4t3KAp8q7v0DMxDuKdxExRE61RlsYe2A+fBsAHepXeCXIvzCmxTxaiYRKRV1VZi6jJtFI9QB6HmKBNC/QuQZcJRptmDEY22/u+AtN8kpViDZzq26fy6uD5GYDuYWipwsrVhUSi5IakL01jzG1nDIq/Q+U0OzES9oow+2FEzyjMS/faP/I0shPDmyHwecZHimlg7ue0cVJIpwCocqXfkcY3ShmcWA3qih64uFTetSjtP3UJrpAUo+rfGktAH51dzxqmEY+I6TmfA6t7p0ztURFoR/dRENbIw7ouTcmRyWl6y/OxHnki6g3X3kxZPZZmQbMi0y6OmkKDtefGaJdvM1clGhqwlxOPs3yIGSG7jBCKe4cLzWT7TOwkO3GDaW9rTrgHaYTjq+HUkIrkU2ZEJLMN4ufuwSFJ4l+VvwFmi7buiiV1vSR+29kasGFdUNcAeuuZhsliD9AzK23+HNB1wTm12JtM=
python:
  - "3.4"
services:
  - docker
cache:
  bundler: true
  directories: $TRAVIS_BUILD_DIR/tmp/.htmlproofer
addons:
  apt:
    packages:
    - libcurl4-openssl-dev
    - ca-certificates
before_install: 
    - gem update --system --no-doc
    - bundle install --gemfile=Gemfile
    - pip install --user pathlib
matrix:
  include:
    - env: build_docker=true
      script:
      - rake docker:build
      - if [ "$TRAVIS_PULL_REQUEST" != "false" ]; then 
        git commit -m 'Updates site count' ./_includes/count_support.html\
        git push origin HEAD:master 
        fi
    - env: NOKOGIRI_USE_SYSTEM_LIBRARIES=true
      script:
      - bundle exec rake proof_external
      - bundle exec rake verify_images
  allow_failures:
    - script: bundle exec rake proof_external
  after_success:
    - if ["$TRAVIS_BRANCH" == "master" && "$build_docker" == "true"]; then
      docker login -u "$DOCKER_USERNAME" -p "$DOCKER_PASSWORD"
      docker push kenman345/acceptbitcoincashdocker;
      fi